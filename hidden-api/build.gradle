plugins {
    id 'com.android.library'
}

android {
    namespace 'com.neoapps.hiddenapi'
    compileSdk 35
    buildFeatures {
        aidl true
    }

    sourceSets {
        main {
            java.srcDirs = ['src']
            aidl.srcDirs = ['src']
            res.srcDirs = ['res']
        }
    }

    compileOptions {
        sourceCompatibility JavaVersion.VERSION_21
        targetCompatibility JavaVersion.VERSION_21
    }

    gradle.projectsEvaluated {
        def frameworkJar = fileTree(dir: 'libs', include: ['framework-15.jar']).files.singleFile
        gradle.projectsEvaluated {
            tasks.withType(JavaCompile).configureEach {
                classpath = files(frameworkJar, classpath)
            }
            tasks.withType(KotlinCompile).configureEach {
                libraries.from(files(frameworkJar))
            }
        }

        dependencies {
            implementation fileTree(dir: 'libs', include: ['framework-15.jar'])
        }
    }
}

dependencies {
    annotationProcessor 'dev.rikka.tools.refine:annotation-processor:4.4.0'
    compileOnly 'dev.rikka.tools.refine:annotation:4.4.0'
    compileOnly fileTree(dir: 'libs', include: ['framework-15.jar'])
}
